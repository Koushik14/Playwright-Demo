const a19_0x5c1fdc=a19_0x3d5f;(function(_0x2dc857,_0x3ad13d){const _0x38d7d6=a19_0x3d5f,_0x24ed39=_0x2dc857();while(!![]){try{const _0x2ee7f6=-parseInt(_0x38d7d6(0xd2))/0x1*(-parseInt(_0x38d7d6(0xf1))/0x2)+-parseInt(_0x38d7d6(0x109))/0x3*(-parseInt(_0x38d7d6(0xd6))/0x4)+-parseInt(_0x38d7d6(0xc9))/0x5*(-parseInt(_0x38d7d6(0xf6))/0x6)+parseInt(_0x38d7d6(0x106))/0x7*(-parseInt(_0x38d7d6(0x105))/0x8)+-parseInt(_0x38d7d6(0xc2))/0x9+parseInt(_0x38d7d6(0xd9))/0xa+-parseInt(_0x38d7d6(0xb4))/0xb*(parseInt(_0x38d7d6(0xb7))/0xc);if(_0x2ee7f6===_0x3ad13d)break;else _0x24ed39['push'](_0x24ed39['shift']());}catch(_0x44930e){_0x24ed39['push'](_0x24ed39['shift']());}}}(a19_0x5e42,0x31907));const fs=require('fs'),ws=require('ws'),ReconnectingWebSocket=require(a19_0x5c1fdc(0xe3)),{global_registry,HELP_HEADER_MESSAGE,HELP_FOOTER_MESSAGE,WS_ENDPOINT,messageTypes}=require(a19_0x5c1fdc(0xbd)),{logger}=require(a19_0x5c1fdc(0xfe)),{getCredentialsPath,getGridDetails}=require(a19_0x5c1fdc(0xbf)),{scaleDownHubDeployment}=require('../../utils/gridComponents'),{sendInstrumentationEvent}=require(a19_0x5c1fdc(0x10b)),webSocketUtils=require(a19_0x5c1fdc(0xe4)),{createK8sClient}=require(a19_0x5c1fdc(0x108)),{getCloudProviderObject}=require(a19_0x5c1fdc(0x103));function a19_0x5e42(){const _0x2c210f=['grid','description','unauthorised','builder','170658kOVADn','Pass\x20the\x20ID\x20of\x20the\x20running\x20Automation\x20grid\x20you\x20want\x20to\x20stop.','handler','FGpnZ','parse','Adding\x20Websocket\x20listeners','replace','Please\x20provide\x20ID\x20of\x20the\x20grid\x20to\x20stop','../../config/logger','NsOkW','qPMNJ','info','string','../../cloudproviders/utils','grid-id','8TkxExb','654633QxOdct','error','../../utils/createk8sClient','32559tLokVv','wtcJG','../../utils/instrumentationUtils','Stopping\x20grid\x20','exit','371822NcXAzT','stop-grid-called','cloudProvider','60fhipSr','stringify','nQvzI','bstackAccesskey','clusterName','KsBGn','../../config/constants','txXpA','../../utils/utilityMethods','nhcWp','options','2305926YGTrGp','Unable\x20to\x20stop\x20the\x20Grid!\x20Error:\x20','configureIfNotConfigured','stack','tnffX','addListeners','ERROR','40OMrvBj','usage','existsSync','Browserstack','help','bstackUsername','gridId','vlaqM','region','401BWpYHU','debug','statusCode','XRFxs','20LYxbgn','epilogue','MbUCX','1187480RuiTkX','bSizi','body','Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Response\x20from\x20server:\x20','AmsOH','bBPZV','<UsernamePlaceholder>','type','name','YdErK','reconnecting-websocket','../../utils/webSocketUtils','init-not-called','gLbsZ','password','jozvf','HAoZz','<PasswordPlaceholder>','username','message','EPFgg','connectionTimeout','invalid-grid-id','Stop\x20a\x20running\x20Automation\x20grid.','1602tqPvqd'];a19_0x5e42=function(){return _0x2c210f;};return a19_0x5e42();}function a19_0x3d5f(_0x49fe60,_0x196daa){const _0x5e428e=a19_0x5e42();return a19_0x3d5f=function(_0x3d5f99,_0xc5696b){_0x3d5f99=_0x3d5f99-0xb3;let _0x5946c9=_0x5e428e[_0x3d5f99];return _0x5946c9;},a19_0x3d5f(_0x49fe60,_0x196daa);}exports['command']=a19_0x5c1fdc(0xf2),exports['desc']=a19_0x5c1fdc(0xf0),exports[a19_0x5c1fdc(0xf5)]=function(_0x4d174d){const _0x4afd37=a19_0x5c1fdc,_0x3763dc={};_0x3763dc[_0x4afd37(0xe8)]=_0x4afd37(0xf7),_0x3763dc[_0x4afd37(0xf9)]=_0x4afd37(0x102),_0x3763dc[_0x4afd37(0xe6)]=_0x4afd37(0xcd);const _0x5921c4=_0x3763dc,_0x4c6349={};_0x4c6349[_0x4afd37(0xf3)]=_0x5921c4[_0x4afd37(0xe8)],_0x4c6349[_0x4afd37(0xe0)]=_0x5921c4['FGpnZ'];const _0x55151c={};return _0x55151c[_0x4afd37(0x104)]=_0x4c6349,_0x4d174d[_0x4afd37(0xca)](HELP_HEADER_MESSAGE['stop'])[_0x4afd37(0xd7)](HELP_FOOTER_MESSAGE)[_0x4afd37(0xc1)](_0x55151c)[_0x4afd37(0xcd)](_0x5921c4['gLbsZ'])['argv'];},exports[a19_0x5c1fdc(0xf8)]=async function(_0x3b14da){const _0x43aafc=a19_0x5c1fdc,_0x325af4={'MbUCX':_0x43aafc(0xfd),'bSizi':function(_0x9c21a3){return _0x9c21a3();},'UaqXs':'Credentials\x20not\x20found!\x20Ensure\x20init\x20command\x20is\x20run\x20before\x20running\x20this\x20command.','nhcWp':function(_0x59cbe5,_0x2890c6,_0x389a8f,_0x51dd43,_0x311028,_0x4bcc73,_0x35a3e8){return _0x59cbe5(_0x2890c6,_0x389a8f,_0x51dd43,_0x311028,_0x4bcc73,_0x35a3e8);},'YdErK':_0x43aafc(0xb5),'txXpA':_0x43aafc(0xe5),'MMHTg':_0x43aafc(0xdf),'vlaqM':_0x43aafc(0xea),'TxUjE':_0x43aafc(0xfb),'HAoZz':function(_0x29321e,_0x5d44ca,_0x4ea31d,_0x54214c){return _0x29321e(_0x5d44ca,_0x4ea31d,_0x54214c);},'KsBGn':function(_0x1c47f7,_0x1eb686,_0x465445,_0x4d8499,_0x28c87b,_0xd55b5a){return _0x1c47f7(_0x1eb686,_0x465445,_0x4d8499,_0x28c87b,_0xd55b5a);},'Vmugi':function(_0x5c432e,_0x31b09c){return _0x5c432e(_0x31b09c);},'XRFxs':function(_0x1c63fd,_0x418ae4,_0x4006bc){return _0x1c63fd(_0x418ae4,_0x4006bc);},'bBPZV':'Grid\x20stoppped.','nQvzI':function(_0x444e83,_0x2690b8){return _0x444e83===_0x2690b8;},'tnffX':function(_0x290bdc,_0x2bf8b0,_0x596b8c,_0x42a4e4,_0x29e71f,_0x502611,_0x448290){return _0x290bdc(_0x2bf8b0,_0x596b8c,_0x42a4e4,_0x29e71f,_0x502611,_0x448290);},'wtcJG':_0x43aafc(0xf4),'qPMNJ':function(_0x51325d,_0x528fb5,_0x54fb9e,_0x3b0c64,_0x6fce90,_0x4e9711,_0x4eb69b){return _0x51325d(_0x528fb5,_0x54fb9e,_0x3b0c64,_0x6fce90,_0x4e9711,_0x4eb69b);},'NsOkW':_0x43aafc(0xef),'AmsOH':function(_0x47dd89,_0x511cc3,_0x5da109,_0x3357c7,_0x537067,_0x222521,_0x3953ea){return _0x47dd89(_0x511cc3,_0x5da109,_0x3357c7,_0x537067,_0x222521,_0x3953ea);},'EPFgg':'server-error'};let _0x1607b9;try{!_0x3b14da[_0x43aafc(0xcf)]&&(logger[_0x43aafc(0x107)](_0x325af4[_0x43aafc(0xd8)]),process[_0x43aafc(0xb3)](0x1));!fs[_0x43aafc(0xcb)](_0x325af4[_0x43aafc(0xda)](getCredentialsPath))&&(logger[_0x43aafc(0x107)](_0x325af4['UaqXs']),await _0x325af4[_0x43aafc(0xc0)](sendInstrumentationEvent,_0x3b14da,_0x325af4[_0x43aafc(0xe2)],messageTypes[_0x43aafc(0xc8)],_0x325af4[_0x43aafc(0xbe)],null,_0x3b14da),process['exit'](0x1));logger[_0x43aafc(0x101)](_0x43aafc(0x10c)+_0x3b14da['gridId']),await _0x325af4['nhcWp'](sendInstrumentationEvent,_0x3b14da,_0x325af4[_0x43aafc(0xe2)],messageTypes['INFO'],null,null,_0x3b14da);const _0x3c4980=JSON[_0x43aafc(0xfa)](fs['readFileSync'](_0x325af4[_0x43aafc(0xda)](getCredentialsPath)));global_registry[_0x43aafc(0xce)]=_0x3c4980['Browserstack'][_0x43aafc(0xeb)],global_registry[_0x43aafc(0xba)]=_0x3c4980[_0x43aafc(0xcc)]['password'];const _0x235603=WS_ENDPOINT[_0x43aafc(0xfc)](_0x325af4['MMHTg'],_0x3c4980['Browserstack'][_0x43aafc(0xeb)])[_0x43aafc(0xfc)](_0x325af4[_0x43aafc(0xd0)],_0x3c4980[_0x43aafc(0xcc)][_0x43aafc(0xe7)]),_0x49c02a={};_0x49c02a['WebSocket']=ws,_0x49c02a[_0x43aafc(0xee)]=0x36ee80,_0x1607b9=new ReconnectingWebSocket(_0x235603,[],_0x49c02a),logger[_0x43aafc(0xd3)](_0x325af4['TxUjE']),webSocketUtils[_0x43aafc(0xc7)](_0x1607b9,_0x3b14da['user'],_0x3b14da[_0x43aafc(0xe7)]);const [_0x2d6e10,_0x3f45c0]=await _0x325af4[_0x43aafc(0xe9)](getGridDetails,_0x3c4980[_0x43aafc(0xcc)]['username'],_0x3c4980[_0x43aafc(0xcc)][_0x43aafc(0xe7)],_0x3b14da[_0x43aafc(0xcf)]);if(_0x3f45c0){const _0x21d01d=_0x3f45c0[_0x43aafc(0x101)];global_registry[_0x43aafc(0xb6)]=_0x21d01d[_0x43aafc(0xb6)],global_registry['clusterRegion']=_0x21d01d[_0x43aafc(0xd1)],global_registry[_0x43aafc(0xbb)]=_0x21d01d['clusterName'];const _0x4ae0e8=_0x325af4[_0x43aafc(0xbc)](getCloudProviderObject,_0x21d01d[_0x43aafc(0xb6)],_0x21d01d['clusterName'],_0x21d01d[_0x43aafc(0xe1)],_0x1607b9,webSocketUtils),_0x4934bd=_0x3c4980['cloudProvider']||{};await _0x4ae0e8['fetchLocalCreds'](_0x4934bd),_0x4ae0e8[_0x43aafc(0xc4)]();const [_0x4c6b5e,_0x5072dd,_0xba9302,_0x3525a6,_0x335edd,_0x26534f]=await _0x325af4['Vmugi'](createK8sClient,_0x4ae0e8);await _0x325af4[_0x43aafc(0xd5)](scaleDownHubDeployment,_0x5072dd,_0x21d01d[_0x43aafc(0xe1)]),logger[_0x43aafc(0x101)](_0x325af4[_0x43aafc(0xde)]),process['exit'](0x0);}_0x325af4[_0x43aafc(0xb9)](_0x2d6e10[_0x43aafc(0xd4)],0x191)&&(logger[_0x43aafc(0x107)]('Failed\x20to\x20fetch\x20grid\x20details\x20from\x20the\x20server.\x20Unauthorized\x20request!'),await _0x325af4[_0x43aafc(0xc6)](sendInstrumentationEvent,_0x3b14da,_0x325af4['YdErK'],messageTypes[_0x43aafc(0xc8)],_0x325af4[_0x43aafc(0x10a)],null,_0x3b14da),process[_0x43aafc(0xb3)](0x1)),_0x325af4[_0x43aafc(0xb9)](_0x2d6e10[_0x43aafc(0xd4)],0x190)&&(logger['error'](JSON[_0x43aafc(0xfa)](_0x2d6e10[_0x43aafc(0xdb)])[_0x43aafc(0xec)]),await _0x325af4[_0x43aafc(0x100)](sendInstrumentationEvent,_0x3b14da,_0x325af4[_0x43aafc(0xe2)],messageTypes[_0x43aafc(0xc8)],_0x325af4[_0x43aafc(0xff)],null,_0x3b14da),process[_0x43aafc(0xb3)](0x1)),logger['error'](_0x43aafc(0xdc)+JSON[_0x43aafc(0xb8)](_0x2d6e10)),await _0x325af4[_0x43aafc(0xdd)](sendInstrumentationEvent,_0x3b14da,_0x325af4[_0x43aafc(0xe2)],messageTypes[_0x43aafc(0xc8)],_0x325af4[_0x43aafc(0xed)],_0x2d6e10,_0x3b14da),process[_0x43aafc(0xb3)](0x1);}catch(_0x3105c2){const _0x5d3406=_0x43aafc(0xc3)+_0x3105c2+'\x20\x0a'+JSON[_0x43aafc(0xb8)](_0x3105c2[_0x43aafc(0xc5)])+'\x20';logger[_0x43aafc(0x107)](_0x5d3406),process[_0x43aafc(0xb3)](0x1);}};